# Story 1.2: Fond d'écran - Intégration ShaderGradient

## Status
Draft

## Story

**As a** utilisateur du portfolio,  
**I want** pouvoir choisir un fond d'écran avec effet shader gradient animé,  
**so that** j'ai une alternative visuelle moderne aux sphères 3D.

## Contexte et objectif

### Contexte
Cette story ajoute un deuxième type de fond d'écran utilisant @shadergradient/react, une bibliothèque pour créer des gradients animés avec shaders.

### Objectif
Intégrer ShaderGradient comme alternative aux sphères 3D, permettant à l'utilisateur de choisir entre différents styles de fonds d'écran (via Story 1.3 Settings).

### Dépendances
- **Requiert Story 1.1** : Le système WallpaperProvider doit être en place
- **Prérequis pour Story 1.3** : Cette story doit être complète avant l'interface Settings

## Scope précis

### In Scope ✅
- Installation @shadergradient/react + peer dependencies
- Création composant `WallpaperShaderGradient`
- Intégration dans WallpaperProvider (ajout type 'shader-gradient')
- Configuration preset par défaut
- Gestion erreurs ShaderGradient (fallback vers sphères 3D ou CSS)
- Performance optimisée (lazy loading si nécessaire)

### Out of Scope ❌
- Interface Settings pour changer (Story 1.3)
- Configuration avancée presets (hardcodé preset 'default' pour MVP)
- Persistance préférence (Story 1.3)

## Acceptance Criteria

1. **AC1 - Installation dépendances**
   - @shadergradient/react installé avec peer deps (three, @react-three/fiber, three-stdlib, camera-controls)
   - Pas d'erreurs de build/runtime

2. **AC2 - Composant ShaderGradient**
   - Composant WallpaperShaderGradient créé et fonctionnel
   - Affichage gradient animé correct derrière Desktop
   - Preset 'default' utilisé

3. **AC3 - Intégration Provider**
   - Type 'shader-gradient' ajouté à WALLPAPER_TYPES
   - WallpaperProvider gère le type shader-gradient
   - Switch entre sphères 3D et shader-gradient fonctionne (via state)

4. **AC4 - Gestion erreurs**
   - Si ShaderGradient échoue : fallback vers sphères 3D
   - Si sphères 3D aussi échoue : fallback CSS
   - Pas de crash visible utilisateur

5. **AC5 - Performance**
   - Animation fluide 60fps
   - Pas d'impact négatif sur performance Desktop
   - Bundle size acceptable (code splitting maintenu)

## Impacts

### Fichiers/Modules à créer
- `src/components/Wallpaper/WallpaperShaderGradient.jsx` - Composant gradient shader
- `src/components/Wallpaper/WallpaperShaderGradient.module.css` - Styles (minimal)

### Fichiers à modifier
- `src/constants/wallpaper.js` - Ajouter type SHADER_GRADIENT
- `src/components/Wallpaper/WallpaperProvider.jsx` - Gérer type shader-gradient, fallback
- `package.json` - Ajouter dépendances

### Endpoints
**Aucun**

### Base de données
**Aucune**

### Dépendances npm
```bash
npm install @shadergradient/react camera-controls three-stdlib
# Note: three et @react-three/fiber déjà installés dans Story 1.1
```

## Tasks / Subtasks

- [ ] **Task 1: Installation dépendances** (AC: 1)
  - [ ] Installer @shadergradient/react, camera-controls, three-stdlib
  - [ ] Vérifier peer dependencies (three, @react-three/fiber déjà présents)
  - [ ] Tester build sans erreurs

- [ ] **Task 2: Mise à jour constants** (AC: 3)
  - [ ] Modifier `src/constants/wallpaper.js`
  - [ ] Ajouter `SHADER_GRADIENT: 'shader-gradient'` à WALLPAPER_TYPES
  - [ ] Ajouter config par défaut shader-gradient (preset: 'default')

- [ ] **Task 3: Composant WallpaperShaderGradient** (AC: 2, 5)
  - [ ] Créer `src/components/Wallpaper/WallpaperShaderGradient.jsx`
  - [ ] Utiliser composant ShaderGradient de @shadergradient/react
  - [ ] Configurer preset 'default'
  - [ ] Intégrer dans Canvas Three.js (compatible avec @react-three/fiber)
  - [ ] Optimiser performance (lazy loading si bundle trop lourd)

- [ ] **Task 4: Intégration Provider** (AC: 3, 4)
  - [ ] Modifier WallpaperProvider pour gérer type 'shader-gradient'
  - [ ] Ajouter logique switch entre sphères 3D et shader-gradient
  - [ ] Implémenter fallback : shader-gradient → sphères 3D → CSS
  - [ ] Gérer erreurs ShaderGradient (try/catch, ErrorBoundary si disponible)

- [ ] **Task 5: Tests** (AC: 2, 3, 4)
  - [ ] Test affichage shader-gradient
  - [ ] Test switch entre types
  - [ ] Test fallback si erreur

## Dev Notes

### Architecture technique

**Source: design-solution-par-lot.md#Lot-1**

#### Modèle de données mis à jour
```javascript
// État wallpaper (WallpaperProvider)
{
  currentWallpaper: 'spheres-3d' | 'shader-gradient',
  wallpaperConfig: {
    'spheres-3d': { ... },
    'shader-gradient': {
      preset: 'default', // ou config personnalisée future
    }
  }
}
```

#### Intégration ShaderGradient
ShaderGradient utilise Three.js également, donc doit être intégré dans le même Canvas que les sphères (ou Canvas séparé avec même contexte). Vérifier documentation @shadergradient/react pour pattern recommandé.

#### Fallback Strategy
Ordre de fallback :
1. ShaderGradient (si currentWallpaper === 'shader-gradient')
2. Sphères 3D (si ShaderGradient échoue)
3. CSS dégradé (si tout échoue)

#### Performance
- ShaderGradient peut être lourd, vérifier impact bundle
- Lazy loading du composant si nécessaire (React.lazy)
- Code splitting maintenu (Three.js déjà dans chunk séparé)

### Risques identifiés

1. **Compatibilité Three.js** (Impact: Moyen, Probabilité: Moyenne)
   - ShaderGradient nécessite Three.js, vérifier versions compatibles
   - **Mitigation**: Vérifier peer dependencies avant installation
   - **Rollback**: Désactiver ShaderGradient, garder uniquement sphères 3D

2. **Bundle size** (Impact: Moyen, Probabilité: Faible)
   - ShaderGradient peut ajouter du poids
   - **Mitigation**: Lazy loading, code splitting
   - **Rollback**: Désactiver ShaderGradient si bundle trop lourd

### Plan de rollback

1. **Rollback immédiat**: Désactiver type 'shader-gradient' dans WallpaperProvider
2. **Rollback partiel**: Garder code mais forcer 'spheres-3d' par défaut
3. **Rollback complet**: Supprimer dépendances, restaurer constants

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-27 | 1.0 | Story créée | Bob (SM) |

## Dev Agent Record
_TBD_

## QA Results
_TBD_
